from __future__ import annotations

from typing import Dict, List, Tuple

# Supported languages: English (default), German, French, Greek, Russian, Spanish, Chinese, Japanese
SUPPORTED_LANGS: List[Tuple[str, str]] = [
    ("en", "English"),
    ("de", "Deutsch"),
    ("fr", "Français"),
    ("el", "Ελληνικά"),
    ("ru", "Русский"),
    ("es", "Español"),
    ("zh", "中文"),  # Simplified
    ("ja", "日本語"),
    ("pt", "Português"),
]

# Translation dictionary: key -> per-language string
# Keep keys stable, English values used as default
STRINGS: Dict[str, Dict[str, str]] = {
    # Base / Navbar
    "app.title": {
        "en": "Osteopathic Examination",
        "de": "Osteopathische Untersuchung",
        "fr": "Examen ostéopathique",
        "el": "Οστεοπαθητική Εξέταση",
        "ru": "Остеопатическое обследование",
        "es": "Examen osteopático",
        "zh": "骨科检查",
        "ja": "オステオパシー検査",
    },
    "nav.brand": {
        "en": "OsteoDiag",
        "de": "OsteoDiag",
        "fr": "OsteoDiag",
        "el": "OsteoDiag",
        "ru": "OsteoDiag",
        "es": "OsteoDiag",
        "zh": "OsteoDiag",
        "ja": "OsteoDiag",
    },
    "nav.llm": {
        "en": "LLM:",
        "de": "LLM:",
        "fr": "LLM :",
        "el": "LLM:",
        "ru": "LLM:",
        "es": "LLM:",
        "zh": "LLM：",
        "ja": "LLM：",
    },
    "nav.language": {
        "en": "Language",
        "de": "Sprache",
        "fr": "Langue",
        "el": "Γλώσσα",
        "ru": "Язык",
        "es": "Idioma",
        "zh": "语言",
        "ja": "言語",
    },
    "nav.history": {
        "en": "Examinations",
        "de": "Verlauf",
        "fr": "Historique",
        "el": "Ιστορικό",
        "ru": "История",
        "es": "Historial",
        "zh": "历史",
        "ja": "履歴",
        "pt": "Exames",
    },
    "nav.new_exam": {
        "en": "New examination",
        "de": "Neue Untersuchung",
        "fr": "Nouvel examen",
        "el": "Νέα εξέταση",
        "ru": "Новое обследование",
        "es": "Nuevo examen",
        "zh": "新建检查",
        "ja": "新規検査",
        "pt": "Novo exame",
    },
    "nav.users": {
        "en": "Users",
        "de": "Benutzer",
        "fr": "Utilisateurs",
        "el": "Χρήστες",
        "ru": "Пользователи",
        "es": "Usuarios",
        "zh": "用户",
        "ja": "ユーザー",
    },
    "nav.login": {
        "en": "Login",
        "de": "Anmelden",
        "fr": "Se connecter",
        "el": "Σύνδεση",
        "ru": "Войти",
        "es": "Iniciar sesión",
        "zh": "登录",
        "ja": "ログイン",
    },
    "nav.logout": {
        "en": "Logout",
        "de": "Abmelden",
        "fr": "Se déconnecter",
        "el": "Αποσύνδεση",
        "ru": "Выйти",
        "es": "Cerrar sesión",
        "zh": "退出登录",
        "ja": "ログアウト",
    },
    "nav.register": {
        "en": "Register",
        "de": "Registrieren",
        "fr": "S'inscrire",
        "el": "Εγγραφή",
        "ru": "Регистрация",
        "es": "Registrarse",
        "zh": "注册",
        "ja": "登録",
    },

    # Index page
    "index.heading": {
        "en": "Osteopathic Examination (WHO Five Models)",
        "de": "Osteopathische Untersuchung (WHO, Fünf Modelle)",
        "fr": "Examen ostéopathique (cinq modèles OMS)",
        "el": "Οστεοπαθητική Εξέταση (Πέντε Μοντέλα ΠΟΥ)",
        "ru": "Остеопатическое обследование (пять моделей ВОЗ)",
        "es": "Examen osteopático (cinco modelos OMS)",
        "zh": "骨科检查（世卫组织五大模型）",
        "ja": "オステオパシー検査（WHO 5モデル）",
    },
    "btn.load_json": {
        "en": "Load JSON into form",
        "de": "JSON in Formular laden",
        "fr": "Charger JSON dans le formulaire",
        "el": "Φόρτωση JSON στη φόρμα",
        "ru": "Загрузить JSON в форму",
        "es": "Cargar JSON en el formulario",
        "zh": "将 JSON 加载到表单",
        "ja": "JSON をフォームに読み込む",
    },
    "btn.load_demo": {
        "en": "Load demo",
        "de": "Beispiel laden",
        "fr": "Charger démo",
        "el": "Φόρτωση δείγματος",
        "ru": "Загрузить демо",
        "es": "Cargar demostración",
        "zh": "加载演示",
        "ja": "デモを読み込む",
    },
    "section.patient_info": {
        "en": "Patient Information",
        "de": "Patienteninformationen",
        "fr": "Informations du patient",
        "el": "Στοιχεία ασθενούς",
        "ru": "Информация о пациенте",
        "es": "Información del paciente",
        "zh": "患者信息",
        "ja": "患者情報",
    },
    "label.name": {
        "en": "Name",
        "de": "Name",
        "fr": "Nom",
        "el": "Όνομα",
        "ru": "Имя",
        "es": "Nombre",
        "zh": "姓名",
        "ja": "氏名",
    },
    "label.age": {
        "en": "Age",
        "de": "Alter",
        "fr": "Âge",
        "el": "Ηλικία",
        "ru": "Возраст",
        "es": "Edad",
        "zh": "年龄",
        "ja": "年齢",
    },
    "label.sex": {
        "en": "Sex",
        "de": "Geschlecht",
        "fr": "Sexe",
        "el": "Φύλο",
        "ru": "Пол",
        "es": "Sexo",
        "zh": "性别",
        "ja": "性別",
    },
    "select.placeholder": {
        "en": "Select...",
        "de": "Auswählen...",
        "fr": "Sélectionner...",
        "el": "Επιλέξτε...",
        "ru": "Выбрать...",
        "es": "Seleccionar...",
        "zh": "请选择...",
        "ja": "選択...",
    },
    "sex.female": {
        "en": "Female",
        "de": "Weiblich",
        "fr": "Femme",
        "el": "Γυναίκα",
        "ru": "Женский",
        "es": "Femenino",
        "zh": "女",
        "ja": "女性",
    },
    "sex.male": {
        "en": "Male",
        "de": "Männlich",
        "fr": "Homme",
        "el": "Άνδρας",
        "ru": "Мужской",
        "es": "Masculino",
        "zh": "男",
        "ja": "男性",
    },
    "sex.other": {
        "en": "Other",
        "de": "Andere",
        "fr": "Autre",
        "el": "Άλλο",
        "ru": "Другое",
        "es": "Otro",
        "zh": "其他",
        "ja": "その他",
    },
    "label.chief_complaint": {
        "en": "Chief complaint",
        "de": "Hauptbeschwerde",
        "fr": "Motif principal",
        "el": "Κύριο σύμπτωμα",
        "ru": "Основная жалоба",
        "es": "Queja principal",
        "zh": "主诉",
        "ja": "主訴",
    },
    "label.history": {
        "en": "History",
        "de": "Anamnese",
        "fr": "Antécédents",
        "el": "Ιστορικό",
        "ru": "Анамнез",
        "es": "Historia clínica",
        "zh": "病史",
        "ja": "既往歴",
    },
    "label.red_flags": {
        "en": "Red flags screened",
        "de": "Red Flags geprüft",
        "fr": "Signes d’alerte évalués",
        "el": "Έλεγχος κόκκινων σημαιών",
        "ru": "Проверены красные флаги",
        "es": "Banderas rojas evaluadas",
        "zh": "危险信号筛查",
        "ja": "レッドフラッグの確認",
    },
    "label.vitals": {
        "en": "Vitals / Physical exam",
        "de": "Vitalwerte / Körperliche Untersuchung",
        "fr": "Signes vitaux / Examen physique",
        "el": "Ζωτικά / Φυσική εξέταση",
        "ru": "Витальные показатели / Осмотр",
        "es": "Signos vitales / Examen físico",
        "zh": "生命体征 / 体格检查",
        "ja": "バイタル / 身体診察",
    },
    "label.goals": {
        "en": "Patient goals",
        "de": "Ziele des Patienten",
        "fr": "Objectifs du patient",
        "el": "Στόχοι ασθενούς",
        "ru": "Цели пациента",
        "es": "Objetivos del paciente",
        "zh": "患者目标",
        "ja": "患者の目標",
    },
    "section.who_models": {
        "en": "WHO Five Models",
        "de": "WHO Fünf Modelle",
        "fr": "Cinq modèles de l’OMS",
        "el": "Τα Πέντε Μοντέλα του ΠΟΥ",
        "ru": "Пять моделей ВОЗ",
        "es": "Cinco modelos de la OMS",
        "zh": "世卫组织五大模型",
        "ja": "WHO 5モデル",
    },
    "label.biomechanical": {
        "en": "Biomechanical / Structural",
        "de": "Biomechanisch / Strukturell",
        "fr": "Biomécanique / Structurel",
        "el": "Βιομηχανικό / Δομικό",
        "ru": "Биомеханический / Структурный",
        "es": "Biomecánico / Estructural",
        "zh": "生物力学/结构",
        "ja": "バイオメカニカル / 構造",
    },
    "label.respiratory": {
        "en": "Respiratory / Circulatory",
        "de": "Respiratorisch / Zirkulatorisch",
        "fr": "Respiratoire / Circulatoire",
        "el": "Αναπνευστικό / Κυκλοφορικό",
        "ru": "Дыхательный / Кровообращение",
        "es": "Respiratorio / Circulatorio",
        "zh": "呼吸/循环",
        "ja": "呼吸 / 循環",
    },
    "label.metabolic": {
        "en": "Metabolic / Nutritional",
        "de": "Metabolisch / Ernährungsbezogen",
        "fr": "Métabolique / Nutritionnel",
        "el": "Μεταβολικό / Διατροφικό",
        "ru": "Метаболический / Пищевой",
        "es": "Metabólico / Nutricional",
        "zh": "代谢/营养",
        "ja": "代謝 / 栄養",
    },
    "label.neuro": {
        "en": "Neurological",
        "de": "Neurologisch",
        "fr": "Neurologique",
        "el": "Νευρολογικό",
        "ru": "Неврологический",
        "es": "Neurológico",
        "zh": "神经系统",
        "ja": "神経学的",
    },
    "label.behavioral": {
        "en": "Behavioral / Biopsychosocial",
        "de": "Verhaltensbezogen / Biopsychosozial",
        "fr": "Comportemental / Biopsychosocial",
        "el": "Συμπεριφορικό / Βιοψυχοκοινωνικό",
        "ru": "Поведенческий / Биопсихосоциальный",
        "es": "Conductual / Biopsicosocial",
        "zh": "行为/生物心理社会",
        "ja": "行動 / バイオサイコソーシャル",
    },
    "btn.generate": {
        "en": "Generate Summary, Diagnosis & Plan",
        "de": "Zusammenfassung, Diagnose & Plan erzeugen",
        "fr": "Générer Résumé, Diagnostic et Plan",
        "el": "Δημιουργία Περίληψης, Διάγνωσης & Πλάνου",
        "ru": "Сгенерировать сводку, диагноз и план",
        "es": "Generar resumen, diagnóstico y plan",
        "zh": "生成摘要、诊断和计划",
        "ja": "要約・診断・計画を生成",
        "pt": "Gerar Resumo, Diagnóstico e Plano",
    },
    "btn.save": {
        "en": "Save",
        "de": "Speichern",
        "fr": "Enregistrer",
        "el": "Αποθήκευση",
        "ru": "Сохранить",
        "es": "Guardar",
        "zh": "保存",
        "ja": "保存",
        "pt": "Salvar",
    },

    "examination.item": {
        "en": "Examination",
        "pt": "Exame"
    },
    "examinations.running": {
        "en": "Running processes",
        "pt": "Processos em execução"
    },
    "msg.no_examinations": {
        "en": "No examinations yet.",
        "pt": "Nenhum exame ainda."
    },
    "examinations.drafts": {
        "en": "Drafts",
        "pt": "Rascunhos"
    },
    "msg.no_drafts": {
        "en": "No drafts yet.",
        "pt": "Nenhum rascunho ainda."
    },
    "column.id": {
        "en": "ID",
        "pt": "ID"
    },
    "column.updated": {
        "en": "Updated",
        "pt": "Atualizado"
    },
    "column.user": {
        "en": "User",
        "pt": "Usuário"
    },
    "column.lang": {
        "en": "Language",
        "pt": "Idioma"
    },
    "btn.open": {
        "en": "Open",
        "pt": "Abrir"
    },
    "btn.delete": {
        "en": "Delete",
        "pt": "Excluir"
    },
    "confirm.delete_draft": {
        "en": "Delete this draft? This cannot be undone.",
        "pt": "Excluir este rascunho? Esta ação não pode ser desfeita."
    },
    "flash.draft_deleted": {
        "en": "Draft deleted.",
        "pt": "Rascunho excluído."
    },

    # Placeholders (main page)
    "ph.name": {
        "en": "John Doe",
        "de": "Max Mustermann",
        "fr": "Jean Dupont",
        "el": "Γιάννης Παπαδόπουλος",
        "ru": "Иван Иванов",
        "es": "Juan Pérez",
        "zh": "张三",
        "ja": "山田 太郎",
    },
    "ph.chief": {
        "en": "Main symptoms, onset, duration, aggravating/relieving factors",
        "de": "Hauptsymptome, Beginn, Dauer, verschlimmernde/entlastende Faktoren",
        "fr": "Symptômes principaux, début, durée, facteurs aggravants/soulageants",
        "el": "Κύρια συμπτώματα, έναρξη, διάρκεια, επιδεινωτικοί/ανακουφιστικοί παράγοντες",
        "ru": "Основные симптомы, начало, длительность, усиливающие/облегчающие факторы",
        "es": "Síntomas principales, inicio, duración, factores que agravan/alivian",
        "zh": "主要症状、起病、持续时间、加重/缓解因素",
        "ja": "主な症状、発症、期間、増悪/軽快因子",
    },
    "ph.history": {
        "en": "Medical/surgical history, medications, allergies, imaging",
        "de": "Medizinische/operative Vorgeschichte, Medikamente, Allergien, Bildgebung",
        "fr": "Antécédents médicaux/chirurgicaux, médicaments, allergies, imagerie",
        "el": "Ιατρικό/χειρουργικό ιστορικό, φάρμακα, αλλεργίες, απεικόνιση",
        "ru": "Медицинский/хирургический анамнез, лекарства, аллергии, визуализация",
        "es": "Antecedentes médicos/quirúrgicos, medicación, alergias, imágenes",
        "zh": "既往病史/手术史、用药、过敏、影像学",
        "ja": "既往歴/手術歴、内服、アレルギー、画像",
    },
    "ph.red_flags": {
        "en": "If any red flags present, note and consider referral",
        "de": "Falls Red Flags vorhanden, vermerken und Überweisung erwägen",
        "fr": "S'il existe des signes d’alarme, noter et envisager une orientation",
        "el": "Αν υπάρχουν κόκκινες σημαίες, σημειώστε και εξετάστε παραπομπή",
        "ru": "При наличии «красных флагов» отметьте и подумайте о направлении",
        "es": "Si hay banderas rojas, anótelas y considere derivación",
        "zh": "如有危险信号，请注明并考虑转诊",
        "ja": "レッドフラッグがあれば記載し、紹介を検討",
    },
    "ph.vitals": {
        "en": "BP, HR, RR, SpO2, posture, gait, ROM, tenderness",
        "de": "RR, HF, AF, SpO2, Haltung, Gangbild, ROM, Druckschmerz",
        "fr": "TA, FC, FR, SpO2, posture, marche, ADM, douleur à la palpation",
        "el": "ΑΠ, ΣΦ, ΑΑ, SpO2, στάση, βάδισμα, ΕΚΤ, ευαισθησία",
        "ru": "АД, ЧСС, ЧДД, SpO2, осанка, походка, ОД, болезненность",
        "es": "PA, FC, FR, SpO2, postura, marcha, ADM, sensibilidad",
        "zh": "血压、心率、呼吸、血氧、体态、步态、关节活动、压痛",
        "ja": "血圧、心拍数、呼吸数、SpO2、姿勢、歩行、可動域、圧痛",
    },
    "ph.goals": {
        "en": "Desired outcomes, functional goals",
        "de": "Gewünschte Ergebnisse, funktionelle Ziele",
        "fr": "Résultats souhaités, objectifs fonctionnels",
        "el": "Επιθυμητά αποτελέσματα, λειτουργικοί στόχοι",
        "ru": "Желаемые результаты, функциональные цели",
        "es": "Resultados deseados, objetivos funcionales",
        "zh": "期望结果、功能目标",
        "ja": "望ましい結果、機能目標",
    },
    "ph.biomechanical": {
        "en": "Somatic dysfunctions, posture, fascial restrictions",
        "de": "Somatische Dysfunktionen, Haltung, Faszienrestriktionen",
        "fr": "Dysfonctions somatiques, posture, restrictions fasciales",
        "el": "Σωματικές δυσλειτουργίες, στάση, περιορισμοί περιτονίας",
        "ru": "Соматические дисфункции, осанка, фасциальные ограничения",
        "es": "Disfunciones somáticas, postura, restricciones fasciales",
        "zh": "躯体功能障碍、姿势、筋膜限制",
        "ja": "体性機能障害、姿勢、筋膜の制限",
    },
    "ph.respiratory": {
        "en": "Breathing pattern, rib motion, lymphatic/venous return",
        "de": "Atemmuster, Rippenbewegung, lymphatischer/venöser Rückfluss",
        "fr": "Pattern respiratoire, mobilité costale, retour lymphatique/veineux",
        "el": "Ρυθμός αναπνοής, κίνηση πλευρών, λεμφική/φλεβική επιστροφή",
        "ru": "Дыхательный паттерн, движение ребер, лимфатический/венозный отток",
        "es": "Patrón respiratorio, movilidad costal, retorno linfático/venoso",
        "zh": "呼吸模式、肋骨活动、淋巴/静脉回流",
        "ja": "呼吸パターン、肋骨運動、リンパ/静脈還流",
    },
    "ph.metabolic": {
        "en": "Endocrine, inflammatory status, nutrition, sleep",
        "de": "Endokrin, Entzündungsstatus, Ernährung, Schlaf",
        "fr": "Endocrinien, statut inflammatoire, nutrition, sommeil",
        "el": "Ενδοκρινικό, φλεγμονώδης κατάσταση, διατροφή, ύπνος",
        "ru": "Эндокринный, воспалительный статус, питание, сон",
        "es": "Endocrino, estado inflamatorio, nutrición, sueño",
        "zh": "内分泌、炎症状态、营养、睡眠",
        "ja": "内分泌、炎症状態、栄養、睡眠",
    },
    "ph.neurological": {
        "en": "Autonomic balance, pain modulation, central/peripheral findings",
        "de": "Autonome Balance, Schmerzmodulation, zentrale/periphere Befunde",
        "fr": "Équilibre autonome, modulation de la douleur, signes centraux/périphériques",
        "el": "Αυτόνομη ισορροπία, τροποποίηση πόνου, κεντρικά/περιφερικά ευρήματα",
        "ru": "Вегетативный баланс, модуляция боли, центральные/периферические находки",
        "es": "Equilibrio autonómico, modulación del dolor, hallazgos centrales/periféricos",
        "zh": "自主神经平衡、疼痛调制、中枢/外周发现",
        "ja": "自律神経バランス、痛みの調節、中枢/末梢の所見",
    },
    "ph.behavioral": {
        "en": "Stress, coping, beliefs, social factors, work",
        "de": "Stress, Coping, Überzeugungen, soziale Faktoren, Arbeit",
        "fr": "Stress, stratégies d’adaptation, croyances, facteurs sociaux, travail",
        "el": "Στρες, αντιμετώπιση, πεποιθήσεις, κοινωνικοί παράγοντες, εργασία",
        "ru": "Стресс, копинг, убеждения, социальные факторы, работа",
        "es": "Estrés, afrontamiento, creencias, factores sociales, trabajo",
        "zh": "压力、应对、信念、社会因素、工作",
        "ja": "ストレス、対処、信念、社会的要因、仕事",
    },

    # Result page
    "result.heading": {
        "en": "Results for",
        "de": "Ergebnisse für",
        "fr": "Résultats pour",
        "el": "Αποτελέσματα για",
        "ru": "Результаты для",
        "es": "Resultados para",
        "zh": "结果：",
        "ja": "結果：",
    },
    "label.llm_provider": {
        "en": "LLM Provider:",
        "de": "LLM-Anbieter:",
        "fr": "Fournisseur LLM :",
        "el": "Πάροχος LLM:",
        "ru": "Провайдер LLM:",
        "es": "Proveedor LLM:",
        "zh": "LLM 提供商：",
        "ja": "LLM プロバイダー：",
    },
    "section.summary": {
        "en": "Summary",
        "de": "Zusammenfassung",
        "fr": "Résumé",
        "el": "Περίληψη",
        "ru": "Сводка",
        "es": "Resumen",
        "zh": "总结",
        "ja": "要約",
    },
    "section.diagnosis": {
        "en": "Diagnosis",
        "de": "Diagnose",
        "fr": "Diagnostic",
        "el": "Διάγνωση",
        "ru": "Диагноз",
        "es": "Diagnóstico",
        "zh": "诊断",
        "ja": "診断",
    },
    "section.plan": {
        "en": "Treatment Plan",
        "de": "Behandlungsplan",
        "fr": "Plan de traitement",
        "el": "Θεραπευτικό Πλάνο",
        "ru": "План лечения",
        "es": "Plan de tratamiento",
        "zh": "治疗计划",
        "ja": "治療計画",
    },
    "msg.no_summary": {
        "en": "No summary returned.",
        "de": "Keine Zusammenfassung zurückgegeben.",
        "fr": "Aucun résumé retourné.",
        "el": "Δεν επιστράφηκε περίληψη.",
        "ru": "Сводка не получена.",
        "es": "No se devolvió resumen.",
        "zh": "未返回摘要。",
        "ja": "要約が返されませんでした。",
    },
    "msg.no_diagnosis": {
        "en": "No diagnosis returned.",
        "de": "Keine Diagnose zurückgegeben.",
        "fr": "Aucun diagnostic retourné.",
        "el": "Δεν επιστράφηκε διάγνωση.",
        "ru": "Диагноз не получен.",
        "es": "No se devolvió diagnóstico.",
        "zh": "未返回诊断。",
        "ja": "診断が返されませんでした。",
    },
    "msg.no_plan": {
        "en": "No plan returned.",
        "de": "Kein Plan zurückgegeben.",
        "fr": "Aucun plan retourné.",
        "el": "Δεν επιστράφηκε πλάνο.",
        "ru": "План не получен.",
        "es": "No se devolvió plan.",
        "zh": "未返回计划。",
        "ja": "計画が返されませんでした。",
    },
    "btn.back": {
        "en": "Back",
        "de": "Zurück",
        "fr": "Retour",
        "el": "Πίσω",
        "ru": "Назад",
        "es": "Volver",
        "zh": "返回",
        "ja": "戻る",
    },
    "result.show_raw": {
        "en": "Show raw LLM output",
        "de": "Rohes LLM-Ergebnis anzeigen",
        "fr": "Afficher la sortie LLM brute",
        "el": "Εμφάνιση ακατέργαστης εξόδου LLM",
        "ru": "Показать сырые данные LLM",
        "es": "Mostrar salida LLM en bruto",
        "zh": "显示原始 LLM 输出",
        "ja": "生の LLM 出力を表示",
    },
    "btn.download_json": {
        "en": "Download JSON",
        "de": "JSON herunterladen",
        "fr": "Télécharger JSON",
        "el": "Λήψη JSON",
        "ru": "Скачать JSON",
        "es": "Descargar JSON",
        "zh": "下载 JSON",
        "ja": "JSON をダウンロード",
    },
    "btn.download_pdf": {
        "en": "Download PDF",
        "de": "PDF herunterladen",
        "fr": "Télécharger PDF",
        "el": "Λήψη PDF",
        "ru": "Скачать PDF",
        "es": "Descargar PDF",
        "zh": "下载 PDF",
        "ja": "PDF をダウンロード",
    },
    "btn.download_docx": {
        "en": "Download DOCX",
        "de": "DOCX herunterladen",
        "fr": "Télécharger DOCX",
        "el": "Λήψη DOCX",
        "ru": "Скачать DOCX",
        "es": "Descargar DOCX",
        "zh": "下载 DOCX",
        "ja": "DOCX をダウンロード",
    },
    "btn.print": {
        "en": "Print",
        "de": "Drucken",
        "fr": "Imprimer",
        "el": "Εκτύπωση",
        "ru": "Печать",
        "es": "Imprimir",
        "zh": "打印",
        "ja": "印刷",
    },

    # Login / Register
    "login.title": {
        "en": "Sign in",
        "de": "Anmelden",
        "fr": "Se connecter",
        "el": "Σύνδεση",
        "ru": "Вход",
        "es": "Iniciar sesión",
        "zh": "登录",
        "ja": "サインイン",
    },
    "login.username": {
        "en": "Username",
        "de": "Benutzername",
        "fr": "Nom d'utilisateur",
        "el": "Όνομα χρήστη",
        "ru": "Имя пользователя",
        "es": "Usuario",
        "zh": "用户名",
        "ja": "ユーザー名",
    },
    "login.password": {
        "en": "Password",
        "de": "Passwort",
        "fr": "Mot de passe",
        "el": "Κωδικός",
        "ru": "Пароль",
        "es": "Contraseña",
        "zh": "密码",
        "ja": "パスワード",
    },
    "login.captcha": {
        "en": "Captcha",
        "de": "Captcha",
        "fr": "Captcha",
        "el": "Captcha",
        "ru": "Капча",
        "es": "Captcha",
        "zh": "验证码",
        "ja": "キャプチャ",
    },
    "login.submit": {
        "en": "Login",
        "de": "Anmelden",
        "fr": "Connexion",
        "el": "Σύνδεση",
        "ru": "Войти",
        "es": "Iniciar sesión",
        "zh": "登录",
        "ja": "ログイン",
    },
    "login.register": {
        "en": "Register",
        "de": "Registrieren",
        "fr": "S'inscrire",
        "el": "Εγγραφή",
        "ru": "Регистрация",
        "es": "Registrarse",
        "zh": "注册",
        "ja": "登録",
    },
    "err.login_invalid": {
        "en": "Invalid username or password.",
        "de": "Ungültiger Benutzername oder Passwort.",
        "fr": "Nom d'utilisateur ou mot de passe invalide.",
        "el": "Μη έγκυρο όνομα χρήστη ή κωδικός.",
        "ru": "Неверные имя пользователя или пароль.",
        "es": "Usuario o contraseña inválidos.",
        "zh": "用户名或密码无效。",
        "ja": "ユーザー名またはパスワードが無効です。",
    },
    "err.login_blocked": {
        "en": "Your account is blocked. Please contact the administrator.",
        "de": "Ihr Konto ist gesperrt. Bitte kontaktieren Sie den Administrator.",
        "fr": "Votre compte est bloqué. Veuillez contacter l'administrateur.",
        "el": "Ο λογαριασμός σας είναι μπλοκαρισμένος. Επικοινωνήστε με τον διαχειριστή.",
        "ru": "Ваш аккаунт заблокирован. Свяжитесь с администратором.",
        "es": "Su cuenta está bloqueada. Por favor, contacte al administrador.",
        "zh": "您的帐户已被封锁。请联系管理员。",
        "ja": "アカウントがブロックされています。管理者に連絡してください。",
    },
    "err.captcha_required": {
        "en": "Captcha is required.",
        "de": "Captcha ist erforderlich.",
        "fr": "Le captcha est requis.",
        "el": "Απαιτείται captcha.",
        "ru": "Требуется капча.",
        "es": "Se requiere captcha.",
        "zh": "需要验证码。",
        "ja": "キャプチャは必須です。",
    },
    "err.captcha_invalid": {
        "en": "Captcha is incorrect.",
        "de": "Captcha ist falsch.",
        "fr": "Le captcha est incorrect.",
        "el": "Το captcha είναι λανθασμένο.",
        "ru": "Капча неверна.",
        "es": "El captcha es incorrecto.",
        "zh": "验证码不正确。",
        "ja": "キャプチャが正しくありません。",
    },
    "register.title": {
        "en": "Register",
        "de": "Registrieren",
        "fr": "S'inscrire",
        "el": "Εγγραφή",
        "ru": "Регистрация",
        "es": "Registrarse",
        "zh": "注册",
        "ja": "登録",
    },
    "register.username": {
        "en": "Username",
        "de": "Benutzername",
        "fr": "Nom d'utilisateur",
        "el": "Όνομα χρήστη",
        "ru": "Имя пользователя",
        "es": "Usuario",
        "zh": "用户名",
        "ja": "ユーザー名",
    },
    "register.password": {
        "en": "Password",
        "de": "Passwort",
        "fr": "Mot de passe",
        "el": "Κωδικός",
        "ru": "Пароль",
        "es": "Contraseña",
        "zh": "密码",
        "ja": "パスワード",
    },
    "register.password2": {
        "en": "Confirm Password",
        "de": "Passwort bestätigen",
        "fr": "Confirmer le mot de passe",
        "el": "Επιβεβαίωση κωδικού",
        "ru": "Подтвердите пароль",
        "es": "Confirmar contraseña",
        "zh": "确认密码",
        "ja": "パスワードの確認",
    },
    "register.submit": {
        "en": "Create account",
        "de": "Konto erstellen",
        "fr": "Créer un compte",
        "el": "Δημιουργία λογαριασμού",
        "ru": "Создать аккаунт",
        "es": "Crear cuenta",
        "zh": "创建账户",
        "ja": "アカウントを作成",
    },

    # Validation / flash
    "err.chief_required": {
        "en": "Chief complaint is required.",
        "de": "Die Hauptbeschwerde ist erforderlich.",
        "fr": "Le motif principal est requis.",
        "el": "Το κύριο σύμπτωμα είναι υποχρεωτικό.",
        "ru": "Требуется указать основную жалобу.",
        "es": "Se requiere la queja principal.",
        "zh": "主诉为必填项。",
        "ja": "主訴は必須です。",
    },
    "err.demo_not_found": {
        "en": "Demo file not found.",
        "de": "Beispieldatei nicht gefunden.",
        "fr": "Fichier de démonstration introuvable.",
        "el": "Το αρχείο επίδειξης δεν βρέθηκε.",
        "ru": "Демонстрационный файл не найден.",
        "es": "Archivo de demostración no encontrado.",
        "zh": "未找到演示文件。",
        "ja": "デモファイルが見つかりません。",
    },
    "err.json_choose": {
        "en": "Please choose a JSON file to upload.",
        "de": "Bitte wählen Sie eine JSON-Datei zum Hochladen aus.",
        "fr": "Veuillez choisir un fichier JSON à téléverser.",
        "el": "Παρακαλώ επιλέξτε ένα αρχείο JSON για μεταφόρτωση.",
        "ru": "Пожалуйста, выберите JSON-файл для загрузки.",
        "es": "Por favor, elija un archivo JSON para cargar.",
        "zh": "请选择要上传的 JSON 文件。",
        "ja": "アップロードする JSON ファイルを選択してください。",
    },
    "err.json_invalid": {
        "en": "Invalid JSON file.",
        "de": "Ungültige JSON-Datei.",
        "fr": "Fichier JSON invalide.",
        "el": "Μη έγκυρο αρχείο JSON.",
        "ru": "Неверный JSON-файл.",
        "es": "Archivo JSON no válido.",
        "zh": "无效的 JSON 文件。",
        "ja": "無効な JSON ファイルです。",
    },
    "err.load_json": {
        "en": "Error loading JSON:",
        "de": "Fehler beim Laden von JSON:",
        "fr": "Erreur lors du chargement du JSON :",
        "el": "Σφάλμα φόρτωσης JSON:",
        "ru": "Ошибка загрузки JSON:",
        "es": "Error al cargar JSON:",
        "zh": "加载 JSON 时出错：",
        "ja": "JSON の読み込みエラー：",
    },
    "flash.draft_saved": {
        "en": "Draft saved.",
        "pt": "Rascunho salvo."
    },
    "err.draft_not_found": {
        "en": "Draft not found.",
        "pt": "Rascunho não encontrado."
    },
}

DEFAULT_LANG = "en"

_lang_codes = {code for code, _ in SUPPORTED_LANGS}


def get_supported_languages() -> List[Tuple[str, str]]:
    return SUPPORTED_LANGS


def normalize_lang(lang: str | None) -> str:
    if not lang:
        return DEFAULT_LANG
    lang = lang.lower()
    if lang in _lang_codes:
        return lang
    # fallback by prefix, e.g., "de-DE" -> "de"
    if "-" in lang:
        pref = lang.split("-", 1)[0]
        if pref in _lang_codes:
            return pref
    return DEFAULT_LANG


def language_name(lang: str) -> str:
    l = normalize_lang(lang)
    for code, name in SUPPORTED_LANGS:
        if code == l:
            return name
    return "English"


def t(key: str, lang: str | None = None) -> str:
    l = normalize_lang(lang)
    entry = STRINGS.get(key)
    if not entry:
        return key
    return entry.get(l) or entry.get(DEFAULT_LANG) or key


def resolve_lang_from_request_args(args) -> str:
    # expects something like flask.request.args or form
    lang = args.get("lang") if hasattr(args, "get") else None
    return normalize_lang(lang)
